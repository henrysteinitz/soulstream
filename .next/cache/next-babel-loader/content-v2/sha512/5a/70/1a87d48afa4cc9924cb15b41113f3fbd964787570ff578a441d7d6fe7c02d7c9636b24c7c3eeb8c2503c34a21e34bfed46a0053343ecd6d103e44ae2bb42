{"ast":null,"code":"/*\n\tmeSpeak-front\tv.2.0.7\n\tbased on speak.js, https://github.com/kripken/speak.js\n\teSpeak and other code here are under the GNU GPL.\n\tmeSpeak (Modular eSpeak) is a mod of 'speak.js' by N.Landsteiner (2011-2020), www.masswerk.at\n\tofficial project page: https://www.masswerk.at/mespeak\n*/\nvar meSpeak = function () {\n  \"use strict\";\n\n  var coreName = 'mespeak-core.js',\n      eSpeakDir = '/espeak',\n      unloading = false,\n      speakQueue = [],\n      deferredLoaders = [],\n      voicesLoaded = {},\n      workerCallbacks = {},\n      defaultVoice = '',\n      AudioAPI = null,\n      canPlay = false,\n      playbackVolume = 1,\n      audioPool = {},\n      webSoundPool = {},\n      audioContext = null,\n      masterOutput = null,\n      masterGain = null,\n      audioAnalyser = null,\n      wsUseTimeout = false,\n      wsStartFromCallback = false,\n      isMobile = typeof navigator !== 'undefined' && navigator.userAgent && /(Mobile|iPhone|iPad|iPod|Android|iOS)/i.test(navigator.userAgent),\n      isSafari = typeof navigator !== 'undefined' && navigator.userAgent && /Safari/.test(navigator.userAgent),\n      hasWorker = !isMobile && false && typeof window.Worker !== 'undefined',\n      audioUnlocked = false,\n      coreReady = false,\n      baseUrl,\n      worker;\n\n  if (typeof navigator !== 'undefined' && navigator.userAgent) {\n    if (navigator.userAgent.indexOf('Chrome') !== -1) {\n      if (parseInt(navigator.userAgent.replace(/^.*?\\bChrome\\/([0-9]+).*$/, '$1'), 10) >= 32) {\n        wsUseTimeout = wsStartFromCallback = true;\n      }\n    } else if (navigator.userAgent.match(/\\bVersion\\/[0-9]+\\.[0-9\\.]+ (Mobile\\/\\w+ )?Safari\\//)) {\n      if (parseInt(navigator.userAgent.replace(/^.*?\\bVersion\\/([0-9]+).*$/, '$1'), 10) >= 9) {\n        wsStartFromCallback = true;\n      }\n    }\n  }\n\n  function loadCore() {\n    if (!baseUrl) {\n      if (document.currentScript) {\n        baseUrl = document.currentScript.src.replace(/[^\\/]+$/, '');\n      } else {\n        var scripts = document.getElementsByTagName('script');\n        baseUrl = scripts[scripts.length - 1].src.replace(/[^\\/]+$/, '');\n      }\n    }\n\n    if (baseUrl) {\n      if (hasWorker) {\n        worker = new Worker(baseUrl + coreName);\n        worker.onmessage = coreReceiver;\n      } else {\n        var nodes = document.getElementsByTagName('head');\n        if (!nodes || !nodes.length) nodes = document.getElementsByTagName('head');\n\n        if (nodes && nodes.length) {\n          var script = document.createElement('script');\n          script.src = baseUrl + coreName;\n          script.onload = coreLoaded;\n          nodes[0].appendChild(script);\n        }\n      }\n\n      return true;\n    } else {\n      if (self.console) console.error('MeSpeak: Failed to determine current script path.');\n      return false;\n    }\n  }\n\n  function coreReceiver(event) {\n    var msgType = event.data.rsp,\n        jobId = event.data.jobId;\n\n    switch (msgType) {\n      case 'ready':\n        try {\n          var t = new ArrayBuffer(1);\n          worker.postMessage({\n            'job': 'test',\n            'jobId': 0,\n            'test': t\n          }, [t]);\n          if (!t.byteLength) worker.postMessage({\n            'job': 'useTransferables',\n            'jobId': 0,\n            'args': true\n          });\n        } catch (e) {}\n\n        coreLoaded();\n        break;\n\n      case 'configLoaded':\n        if (workerCallbacks[jobId]) workerCallbacks[jobId](event.data.success, event.data.message);\n        break;\n\n      case 'voiceLoaded':\n        if (workerCallbacks[jobId]) workerCallbacks[jobId](event.data.success, event.data.message);\n        break;\n\n      case 'wav':\n        if (workerCallbacks[jobId]) workerCallbacks[jobId](event.data.audiodata);\n        break;\n    }\n\n    if (workerCallbacks[jobId]) delete workerCallbacks[jobId];\n  }\n\n  function sendWorkerJob(obj, jobId, callback) {\n    if (typeof callback === 'function') {\n      if (!jobId) jobId = getJobId();\n      workerCallbacks[String(jobId)] = callback;\n    } else {\n      jobId = 0;\n    }\n\n    if (typeof obj.jobId === 'undefined') obj.jobId = String(jobId);\n    worker.postMessage(obj);\n  }\n\n  function coreLoaded() {\n    coreReady = true;\n\n    for (var i = 0, l = deferredLoaders.length; i < l; i++) {\n      var loader = deferredLoaders[i];\n      loader.job.apply(null, loader.args);\n    }\n\n    deferredLoaders.length = 0;\n  }\n\n  function executeQueuedCalls() {\n    if (defaultVoice) {\n      for (var i = 0, l = speakQueue.length; i < l; i++) {\n        var args = speakQueue[i];\n\n        if (args[4]) {\n          speakMultipart(args[0], args[1], args[2], args[3]);\n        } else {\n          speak(args[0], args[1], args[2], args[3]);\n        }\n      }\n\n      speakQueue.length = 0;\n    }\n  }\n\n  function resetQueue() {\n    speakQueue.length = 0;\n  }\n\n  function speak(text, args, callback, id) {\n    if (typeof args !== 'object' || !args) args = {};\n\n    if (!canPlay && !args.rawdata) {\n      if (self.console) console.warn('meSpeak: Can\\'t play; No audio support.');\n      return 0;\n    }\n\n    if (!id) id = getJobId();\n\n    if (!coreReady || !defaultVoice) {\n      if (self.console) console.log('No voice module loaded, deferring call.');\n\n      if (args.rawdata) {\n        return id;\n      } else {\n        speakQueue.push([text, args, callback, id, false]);\n        return id;\n      }\n    }\n\n    if (args && args.voice && !voicesLoaded[args.voice]) {\n      if (self.console) console.log('Voice ' + args.voice + ' not available. Using default voice: ' + defaultVoice);\n      args.voice = defaultVoice;\n    }\n\n    var varg = args.voice ? String(args.voice) : args.v ? String(args.v) : defaultVoice;\n    if (varg.indexOf('mb/mb-') == 0) varg = varg.substring(3);\n    if (args.variant) varg += '+' + String(args.variant).replace(/\\+/g, '');\n    var argstack = ['-w', 'wav.wav', '-a', typeof args.amplitude !== 'undefined' ? String(args.amplitude) : typeof args.a !== 'undefined' ? String(args.a) : '100', '-g', typeof args.wordgap !== 'undefined' ? String(args.wordgap) : typeof args.g !== 'undefined' ? String(args.g) : '0', '-p', typeof args.pitch !== 'undefined' ? String(args.pitch) : typeof args.p !== 'undefined' ? String(args.p) : '50', '-s', typeof args.speed !== 'undefined' ? String(args.speed) : typeof args.s !== 'undefined' ? String(args.s) : '175', '-b', args.utf16 ? '4' : typeof args.b !== 'undefined' ? String(args.b) : '1', '-v', varg];\n    var a = args.linebreak || args.l;\n    if (a) argstack.push('-l', String(a));\n    a = args.capitals || args.k;\n    if (a) argstack.push('-k', String(a));\n    a = args.nostop || args.z;\n    if (a) argstack.push('-z');\n\n    if (typeof args.punct !== 'undefined') {\n      if (typeof args.punct === 'string') {\n        if (args.punct.length) {\n          argstack.push('--punct=\"' + String(args.punct).replace(/([\\\\\"'])/g, '\\\\$1') + '\"');\n        } else {\n          argstack.push('--punct');\n        }\n      } else if (args.punct) {\n        argstack.push('--punct');\n      }\n    }\n\n    a = args.ssml || args.m || args.markup;\n    if (a) argstack.push('-m');\n    argstack.push('--path=' + eSpeakDir, String(text));\n    if (args.log && self.console) console.log('executing espeak ' + argstack.join(' '));\n    if (typeof callback !== 'function') callback = null;\n    if (!callback && typeof args.callback == 'function') callback = args.callback;\n\n    if (!args.rawdata && AudioAPI) {\n      if (!audioContext) audioContext = new AudioAPI();\n      if (audioContext.state === 'suspended') audioContext.resume();\n    }\n\n    if (hasWorker) {\n      sendWorkerJob({\n        'job': 'speak',\n        'args': argstack\n      }, id, function (stream) {\n        resolveUtterance(stream, id, args.rawdata, args.volume, args.pan || 0, callback);\n      });\n    } else {\n      resolveUtterance(meSpeakCore.speak(argstack), id, args.rawdata, args.volume, args.pan || 0, callback);\n    }\n\n    return id;\n  }\n\n  function resolveUtterance(stream, id, rawdata, volume, pan, callback) {\n    if (stream) {\n      if (rawdata) {\n        if (callback) callback(true, id, exportStream(stream, rawdata));\n      } else {\n        playSound(stream, volume, callback, id, pan);\n      }\n    } else if (callback) {\n      callback(false, id);\n    }\n  }\n\n  function exportStream(stream, format) {\n    switch (String(format).toLowerCase()) {\n      case 'array':\n        return Array.from ? Array.from(new Uint8Array(stream)) : Array.prototype.slice.call(new Uint8Array(stream));\n\n      case 'base64':\n        return encode64(stream);\n\n      case 'data-url':\n      case 'data-uri':\n      case 'dataurl':\n      case 'datauri':\n      case 'mime':\n        return 'data:audio/x-wav;base64,' + encode64(new Uint8Array(stream));\n\n      default:\n        return stream;\n    }\n  }\n\n  function encode64(data) {\n    var BASE = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',\n        PAD = '=',\n        ret = '',\n        leftchar = 0,\n        leftbits = 0,\n        l = Object.prototype.toString.call(data) === '[object Array]' ? data.length : data.byteLength;\n\n    for (var i = 0; i < l; i++) {\n      leftchar = leftchar << 8 | data[i];\n      leftbits += 8;\n\n      while (leftbits >= 6) {\n        var curr = leftchar >> leftbits - 6 & 0x3f;\n        leftbits -= 6;\n        ret += BASE[curr];\n      }\n    }\n\n    if (leftbits == 2) {\n      ret += BASE[(leftchar & 3) << 4];\n      ret += PAD + PAD;\n    } else if (leftbits == 4) {\n      ret += BASE[(leftchar & 0xf) << 2];\n      ret += PAD;\n    }\n\n    return ret;\n  }\n\n  function speakMultipart(parts, args, callback, id) {\n    if (typeof args !== 'object' || !args) args = {};\n\n    if (!canPlay && !args.rawdata) {\n      if (self.console) console.warn('meSpeak: Can\\'t play; No audio support.');\n      return 0;\n    }\n\n    var failed = false;\n    if (typeof callback !== 'function') callback = null;\n    if (!callback && typeof args.callback == 'function') callback = args.callback;\n\n    if (Object.prototype.toString.call(parts) != '[object Array]' || !parts.length) {\n      if (self.console) console.warn('meSpeak.speakMultipart: First argument must be an array of objects.');\n      failed = true;\n    }\n\n    if (!failed) {\n      for (var i = 0, l = parts.length; i < l; i++) {\n        if (typeof parts[i] != 'object') {\n          if (self.console) console.warn('meSpeak.speakMultipart: First argument must be an array of objects (part #' + i + ').');\n          failed = true;\n          break;\n        }\n      }\n    }\n\n    if (failed) {\n      if (callback) callback(false, id || 0);\n      return 0;\n    }\n\n    if (!id) id = getJobId();\n\n    if (!coreReady || !defaultVoice) {\n      if (self.console) console.log('No voice module loaded, deferring call.');\n\n      if (args.rawdata) {\n        return null;\n      } else {\n        speakQueue.push([parts, args, callback, id, true]);\n        return id;\n      }\n    }\n\n    var stackLength = parts.length,\n        streams = {},\n        jobIds = [];\n\n    for (var i = 0; i < stackLength; i++) jobIds.push(getJobId());\n\n    for (var i = 0; i < parts.length; i++) {\n      var n,\n          part = parts[i] || {},\n          opts = {};\n\n      for (n in args) opts[n] = args[n];\n\n      for (n in part) opts[n] = part[n];\n\n      opts.rawdata = 'array';\n      opts.callback = null;\n      speak(part.text, opts, function (success, jobId, stream) {\n        if (success) streams[jobId] = stream;\n\n        if (--stackLength === 0) {\n          var wav,\n              sampleLength = 0,\n              first = true;\n\n          for (var i = 0; i < jobIds.length; i++) {\n            var buffer = streams[jobIds[i]];\n\n            if (buffer) {\n              sampleLength += readBytes(buffer, 40, 4);\n\n              if (first) {\n                wav = buffer;\n                first = false;\n              } else {\n                wav = wav.concat(buffer.slice(44));\n              }\n            }\n          }\n\n          streams = buffer = null;\n          writeBytes(wav, 4, 4, sampleLength);\n          writeBytes(wav, 40, 4, sampleLength);\n          var outStream = new ArrayBuffer(wav.length);\n          new Uint8Array(outStream).set(wav);\n          resolveUtterance(outStream, id, args.rawdata, args.volume, args.pan || 0, callback);\n        }\n      }, jobIds[i]);\n    }\n\n    return id;\n  }\n\n  function writeBytes(f, p, n, value) {\n    while (n) {\n      f[p++] = value & 0xff;\n      value = value >> 8;\n      n--;\n    }\n  }\n\n  function readBytes(f, p, n) {\n    var value = 0,\n        shft = 0;\n\n    while (n) {\n      value |= f[p++] << shft;\n      shft += 8;\n      n--;\n    }\n\n    return value;\n  }\n\n  function getJobId() {\n    var n, s;\n\n    while (!n || audioPool[s] || webSoundPool[s] || workerCallbacks[s]) {\n      n = Math.floor(Math.random() * Math.pow(2, 32));\n      s = n.toString();\n    }\n\n    return n;\n  }\n\n  function playSound(stream, relVolume, callback, _id, pan) {\n    if (callback && typeof callback !== 'function') callback = null;\n    if (!_id) _id = getJobId();\n    var streamType = Object.prototype.toString.call(stream);\n\n    if (!(streamType == '[object Array]' || streamType == '[object ArrayBuffer]' || streamType == '[object String]')) {\n      if (self.console) console.log('meSpeak: Can\\'t play, not an Array, or ArrayBuffer, or base64-String: ' + streamType);\n      if (callback) callback(false, _id || 0);\n      return 0;\n    }\n\n    if (typeof relVolume !== 'undefined') {\n      relVolume = parseFloat(relVolume);\n      if (isNaN(relVolume) || relVolume < 0 || relVolume > 1) relVolume = undefined;\n    }\n\n    if (AudioAPI) {\n      if (streamType == '[object String]') {\n        if (stream.indexOf('data:audio/x-wav;base64,', 0) == 0) stream = stream.substring(24);\n        stream = stream.replace(/=+$/, '');\n\n        if (stream.match(/[^A-Za-z0-9\\+\\/]/)) {\n          if (self.console) console.log('meSpeak: Can\\'t play, not a proper base64-String.');\n          if (callback) callback(false, _id || 0);\n          return 0;\n        }\n\n        stream = decodeBase64ToArray(stream);\n\n        if (!stream.length) {\n          if (self.console) console.log('meSpeak: Can\\'t play, empty sound data.');\n          if (callback) callback(false, _id || 0);\n          return 0;\n        }\n\n        streamType = '[object Array]';\n      }\n\n      var buffer;\n\n      if (streamType == '[object Array]') {\n        var buffer = new ArrayBuffer(stream.length);\n        new Uint8Array(buffer).set(stream);\n      } else {\n        buffer = stream;\n      }\n\n      return playWebSound(buffer, relVolume, callback, _id, pan);\n    } else if (canPlay) {\n      var isDataUrl = false;\n\n      if (streamType == '[object String]') {\n        if (stream.indexOf('data:audio/x-wav;base64,', 0) < 0) {\n          if (stream.match(/[^A-Za-z0-9\\+\\/]/)) {\n            if (self.console) console.log('meSpeak: Can\\'t play, not a proper base64-String.');\n            if (callback) callback(false, _id || 0);\n            return 0;\n          }\n\n          stream = 'data:audio/x-wav;base64,' + stream;\n        }\n\n        isDataUrl = true;\n      } else if (streamType == '[object ArrayBuffer]') {\n        stream = new Uint8Array(stream);\n      }\n\n      return new AudioPlayback(stream, relVolume, isDataUrl, callback, _id).started ? _id : 0;\n    } else {\n      if (self.console) console.log('meSpeak: Can\\'t play; No audio support.');\n      if (callback) callback(false, _id || 0);\n      return 0;\n    }\n  }\n\n  function stopSound() {\n    var id,\n        i,\n        k,\n        kl,\n        l,\n        item,\n        n,\n        stopped = 0;\n\n    if (arguments.length > 0) {\n      for (i = 0, l = arguments.length; i < l; i++) {\n        n = parseInt(arguments[i]);\n\n        if (n && !isNaN(n)) {\n          id = n.toString();\n\n          if (audioPool[id]) {\n            audioPool[id].stop();\n            stopped++;\n          } else if (webSoundPool[id]) {\n            stopWebSound(webSoundPool[id]);\n            stopped++;\n          } else {\n            for (k = 0, kl = speakQueue.length; k < kl; k++) {\n              item = speakQueue[i];\n\n              if (item[3].string === id) {\n                if (!unloading && typeof item[2] == 'function') item[2](false);\n                speakQueue.splice(k, 1);\n                stopped++;\n                break;\n              }\n            }\n          }\n        }\n      }\n    } else {\n      for (id in audioPool) {\n        audioPool[id].stop();\n        stopped++;\n      }\n\n      for (id in webSoundPool) {\n        stopWebSound(webSoundPool[id]);\n        stopped++;\n      }\n\n      for (i = 0, l = speakQueue.length; i < l; i++) {\n        item = speakQueue[i];\n        if (!unloading && typeof item[2] == 'function') item[2](false);\n        stopped++;\n      }\n\n      speakQueue.length = 0;\n    }\n\n    return stopped;\n  }\n\n  function setVolume(vol) {\n    var id, i, l, n, v;\n    v = parseFloat(vol);\n\n    if (!isNaN(v) && v >= 0 && v <= 1 && v != playbackVolume) {\n      if (arguments.length == 1) playbackVolume = v;\n\n      if (AudioAPI) {\n        if (arguments.length > 1) {\n          for (i = 0, l = arguments.length; i < l; i++) {\n            n = parseInt(arguments[i]);\n\n            if (n && !isNaN(n)) {\n              id = n.toString();\n              if (webSoundPool[id]) setWebSoundVolume(webSoundPool[id], v);\n            }\n          }\n        } else if (masterGain) {\n          masterGain.gain.value = playbackVolume;\n        }\n      } else if (canPlay) {\n        if (arguments.length > 1) {\n          for (i = 0, l = arguments.length; i < l; i++) {\n            n = parseInt(arguments[i]);\n\n            if (n && !isNaN(n)) {\n              id = n.toString();\n              if (audioPool[id]) audioPool[id].setVolume(v);\n            }\n          }\n        } else {\n          for (id in audioPool) audioPool[id].adjustVolume();\n        }\n      }\n    }\n\n    return vol;\n  }\n\n  function getVolume() {\n    if (arguments.length) {\n      var n = parseInt(arguments[0]);\n\n      if (n && !isNaN(n)) {\n        var id = n.toString();\n        if (webSoundPool[id]) return webSoundPool[id].relVolume;\n        if (audioPool[id]) return audioPool[id].relVolume;\n      }\n\n      return undefined;\n    } else {\n      return playbackVolume;\n    }\n  }\n\n  function resolveAudioApi() {\n    if (self.AudioContext) {\n      AudioAPI = self.AudioContext;\n      canPlay = true;\n      return;\n    } else {\n      var vendors = ['webkit', 'moz', 'o', 'ms'];\n\n      for (var i = 0; i < vendors.length; i++) {\n        var api = self[vendors[i] + 'AudioContext'];\n\n        if (api) {\n          AudioAPI = api;\n          canPlay = true;\n          return;\n        }\n      }\n    }\n\n    if (!AudioAPI) {\n      var audioElement = document.createElement('audio');\n\n      if (audioElement && audioElement.canPlayType && (audioElement.canPlayType('audio/wav') || audioElement.canPlayType('audio/x-wav'))) {\n        canPlay = true;\n      } else {\n        canPlay = false;\n        if (self.console) console.log('meSpeak: Muted. No support for HTMLAudioElement with MIME \"audio/x-wav\" dected.');\n      }\n    }\n  }\n\n  function canPlaybackWav() {\n    return canPlay;\n  }\n\n  function AudioPlayback(stream, relVolume, isDataUrl, callback, id) {\n    this.relVolume = relVolume;\n    this.audio = null;\n    this.id = String(id);\n    this.callback = typeof callback == 'function' ? callback : null;\n    this.playing = false;\n    this.started = false;\n    this.play(stream, isDataUrl);\n  }\n\n  AudioPlayback.prototype = {\n    play: function (stream, isDataUrl) {\n      try {\n        audioPool[this.id] = this;\n        this.audio = document.createElement('audio');\n        this.adjustVolume();\n        var that = this;\n        this.audio.addEventListener('ended', function () {\n          that.remove();\n        }, false);\n        this.audio.addEventListener('canplaythrough', function () {\n          that.audio.play();\n          that.playing = true;\n        }, false);\n\n        if (isDataUrl) {\n          this.audio.src = stream;\n        } else {\n          this.audio.src = 'data:audio/x-wav;base64,' + encode64(stream);\n        }\n\n        this.audio.load();\n        this.started = true;\n      } catch (e) {\n        if (self.console) console.log('meSpeak: HTMLAudioElement Exception: ' + e.message);\n        this.started = false;\n        this.remove();\n      }\n    },\n    adjustVolume: function () {\n      this.audio.volume = typeof this.relVolume !== 'undefined' ? this.relVolume * playbackVolume : playbackVolume;\n    },\n    setVolume: function (v) {\n      this.relVolume = v;\n      this.adjustVolume();\n    },\n    remove: function (stopped) {\n      if (this.id) delete audioPool[this.id];\n\n      if (this.callback) {\n        var f = this.callback;\n        this.callback = null;\n        var id = this.id || 0;\n        if (!unloading) f(!stopped, id);\n      }\n    },\n    stop: function () {\n      try {\n        if (this.playing) this.audio.pause();\n      } catch (e) {}\n\n      this.remove(true);\n    }\n  };\n\n  function playWebSound(stream, volume, callback, id, pan) {\n    try {\n      var source,\n          gainNode,\n          timer,\n          relVolume,\n          sid = String(id);\n\n      if (!audioContext) {\n        audioContext = new AudioAPI();\n      } else if (audioContext.closed) {\n        audioContext = new AudioAPI();\n        audioAnalyser = masterOutput = masterGain = null;\n      }\n\n      if (!masterGain) {\n        masterGain = audioContext.createGain ? audioContext.createGain() : audioContext.createGainNode();\n        masterGain.connect(audioContext.destination);\n        masterGain.gain.value = playbackVolume;\n        if (!masterOutput) masterOutput = masterGain;\n      }\n\n      source = audioContext.createBufferSource();\n      relVolume = parseFloat(volume);\n      if (typeof relVolume === 'undefined' || isNaN(relVolume) || relVolume < 0 || relVolume > 1) relVolume = 1;\n      gainNode = audioContext.createGain ? audioContext.createGain() : audioContext.createGainNode();\n      gainNode.gain.value = relVolume;\n\n      if (pan && !isNaN(pan)) {\n        try {\n          var splitter = audioContext.createChannelSplitter(2),\n              merger = audioContext.createChannelMerger(2),\n              left = audioContext.createGain ? audioContext.createGain() : audioContext.createGainNode(),\n              right = audioContext.createGain ? audioContext.createGain() : audioContext.createGainNode(),\n              ratio = Math.max(-1, Math.min(1, parseFloat(pan))),\n              mixer = audioContext.createGain ? audioContext.createGain() : audioContext.createGainNode();\n          mixer.channelCount = 2;\n          mixer.channelCountMode = 'explicit';\n          mixer.channelInterpretation = 'speakers';\n          left.gain.value = ratio < 0 ? 1 : 1 - ratio;\n          right.gain.value = ratio > 0 ? 1 : 1 + ratio;\n          mixer.connect(splitter);\n          splitter.connect(left, 0);\n          splitter.connect(right, 1);\n          left.connect(merger, 0, 0);\n          right.connect(merger, 0, 1);\n          merger.connect(gainNode);\n          source.connect(mixer);\n        } catch (e) {\n          source.connect(gainNode);\n        }\n      } else {\n        source.connect(gainNode);\n      }\n\n      if (audioAnalyser) gainNode.connect(audioAnalyser);\n      gainNode.connect(masterOutput);\n      audioContext.decodeAudioData(stream, function (audioData) {\n        var f = function () {\n          webSoundEndHandler(source, gainNode, callback, true, id);\n        };\n\n        if (wsUseTimeout || typeof source.onended === 'undefined') {\n          var duration = audioData.duration;\n          timer = setTimeout(f, duration ? Math.ceil(duration * 1000) : 10);\n        } else {\n          source.onended = f;\n        }\n\n        source.buffer = audioData;\n\n        if (wsStartFromCallback) {\n          if (source.start) {\n            source.start(0);\n          } else {\n            source.noteOn(0);\n          }\n        }\n      }, function (err) {\n        console.log('meSpeak: Web Audio Decoding Error: ' + (typeof err == 'object' ? err.message : err));\n        if (timer) clearTimeout(timer);\n        if (source) source.disconnect();\n        if (gainNode) gainNode.disconnect();\n        if (webSoundPool[sid]) delete webSoundPool[sid];\n        if (!unloading && typeof callback == 'function') callback(false, id);\n        return 0;\n      });\n      webSoundPool[sid] = {\n        'source': source,\n        'gainNode': gainNode,\n        'callback': callback,\n        'id': id,\n        'relVolume': relVolume,\n        'timer': timer\n      };\n\n      if (!wsStartFromCallback) {\n        if (source.start) {\n          source.start(0);\n        } else {\n          source.noteOn(0);\n        }\n      }\n\n      return id;\n    } catch (e) {\n      if (self.console) console.log('meSpeak: Web Audio Exception: ' + e.message);\n\n      if (timer) {\n        clearTimeout(timer);\n        timer = 0;\n      }\n\n      webSoundEndHandler(source, gainNode, callback, false, id);\n      return 0;\n    }\n  }\n\n  function webSoundEndHandler(source, gainNode, callback, success, id) {\n    var sid = String(id);\n    if (sid && webSoundPool[sid] && webSoundPool[sid].timer) clearTimeout(webSoundPool[sid].timer);\n    if (!unloading && typeof callback == 'function') callback(success, id);\n\n    var f = function () {\n      if (source) {\n        if (typeof source.onended !== 'undefined') source.onended = null;\n        source.disconnect();\n      }\n\n      if (gainNode) gainNode.disconnect();\n      if (sid && webSoundPool[sid]) delete webSoundPool[sid];\n    };\n\n    if (!success) {\n      f();\n    } else {\n      setTimeout(f, 500);\n    }\n  }\n\n  function stopWebSound(obj) {\n    try {\n      if (obj.source.stop) {\n        obj.source.stop(0);\n      } else {\n        obj.sourcesource.noteOff(0);\n      }\n    } catch (e) {}\n\n    webSoundEndHandler(obj.source, obj.gainNode, obj.callback, false, obj.id);\n  }\n\n  function setFilter() {\n    var biquadProps = ['frequency', 'Q', 'gain', 'detune'],\n        compressorProps = ['threshold', 'knee', 'ratio', 'reduction', 'attack', 'release'];\n    if (!AudioAPI) return;\n\n    if (!audioContext) {\n      audioContext = new AudioAPI();\n    } else if (audioContext.closed) {\n      audioContext = new AudioAPI();\n      audioAnalyser = masterOutput = masterGain = null;\n    }\n\n    var inputNode, outputNode;\n\n    for (var i = 0; i < arguments.length; i++) {\n      var data = arguments[i];\n\n      if (Object.prototype.toString.call(data) !== '[object Object]') {\n        if (self.console) console.warn('meSpeak.setFilter(): argument must be an object, ignoring argument ' + i + '.');\n        continue;\n      }\n\n      var filter,\n          type = String(data.type).toLowerCase();\n\n      switch (type) {\n        case 'lowpass':\n        case 'highpass':\n        case 'bandpass':\n        case 'lowshelf':\n        case 'highshelf':\n        case 'peaking':\n        case 'notch':\n        case 'allpass':\n          try {\n            filter = audioContext.createBiquadFilter();\n            filter.type = type;\n\n            for (var j = 0; j < biquadProps.length; j++) {\n              var p = biquadProps[j];\n\n              try {\n                if (!isNaN(data[p])) filter[p].value = data[p];\n              } catch (e2) {\n                if (self.console) console.warn('meSpeak.setFilter(), filter-type: \"' + type + '\", parameter: \"' + p + '\": ' + e2.message);\n              }\n\n              ;\n            }\n          } catch (e1) {\n            if (self.console) console.warn('meSpeak.setFilter(): Failed to create filter \"' + type + '\", ' + e1.message);\n          }\n\n          ;\n          break;\n\n        case 'dynamicscompressor':\n        case 'compressor':\n          try {\n            filter = audioContext.createDynamicsCompressor();\n\n            for (var j = 0; j < compressorProps.length; j++) {\n              var p = compressorProps[j];\n\n              try {\n                if (!isNaN(data[p])) filter[p].value = data[p];\n              } catch (e2) {\n                if (self.console) console.warn('meSpeak.setFilter(), filter-type: \"' + type + '\", parameter: \"' + p + '\": ' + e2.message);\n              }\n\n              ;\n            }\n\n            break;\n          } catch (e1) {\n            if (self.console) console.warn('meSpeak.setFilter(): Failed to create filter \"' + type + '\", ' + e1.message);\n          }\n\n          ;\n\n        default:\n          if (self.console) console.warn('meSpeak.setFilter(): unknown filter type \"' + type + '\".');\n          filter = null;\n          break;\n      }\n\n      if (filter) {\n        if (!inputNode) {\n          inputNode = filter;\n        } else {\n          inputNode.connect(filter);\n        }\n\n        outputNode = filter;\n      }\n    }\n\n    if (outputNode) {\n      if (!masterGain) {\n        masterGain = audioContext.createGain ? audioContext.createGain() : audioContext.createGainNode();\n        masterGain.connect(audioContext.destination);\n        masterGain.gain.value = playbackVolume;\n      }\n\n      outputNode.connect(masterGain);\n      masterOutput = inputNode;\n    } else {\n      masterOutput = masterGain;\n    }\n  }\n\n  function getAudioAnalyser() {\n    if (!AudioAPI) return;\n\n    if (!audioContext) {\n      audioContext = new AudioAPI();\n    } else if (audioContext.closed) {\n      audioContext = new AudioAPI();\n      audioAnalyser = masterOutput = masterGain = null;\n    }\n\n    audioAnalyser = audioContext.createAnalyser();\n    return audioAnalyser;\n  }\n\n  function setWebSoundVolume(obj, v) {\n    obj.gainNode.gain.value = v;\n    obj.relVolume = v;\n  }\n\n  function setDefaultVoice(voice) {\n    if (voice) {\n      if (!coreReady) {\n        deferredLoaders.push({\n          'job': setDefaultVoice,\n          'args': [voice]\n        });\n      } else if (voicesLoaded[voice]) {\n        defaultVoice = voice;\n      }\n    }\n  }\n\n  function getDefaultVoice() {\n    return defaultVoice;\n  }\n\n  function getRelFileUrl(url) {\n    if (/^(\\/|https?:|ftps?:|file:)/i.test(url)) return url;else {\n      var baseParts = /^(https?|ftps?|file)(\\:\\/\\/)([^\\/]*\\/)(.*)$/i.exec(baseUrl),\n          basePath = baseParts[4].split('/'),\n          filePath = url.split('/');\n\n      for (var i = 0; i < filePath.length; i++) {\n        var p = filePath[i];\n        if (p === '.') continue;\n\n        if (p === '..') {\n          basePath.pop();\n        } else {\n          basePath.push(p);\n        }\n      }\n\n      return baseParts[1] + baseParts[2] + baseParts[3] + basePath.join('/');\n    }\n  }\n\n  function loadVoice(url, callback) {\n    if (url && typeof url === 'string') {\n      if (coreReady) {\n        var handler = function (success, msg) {\n          if (success) onVoiceLoaded(msg);\n          if (typeof callback === 'function') callback(success, msg);\n        };\n\n        if (/^[\\w\\-]+(\\/[\\w\\-]+)?$/.test(url)) {\n          url = 'voices/' + url + '.json';\n        }\n\n        url = getRelFileUrl(url);\n\n        if (hasWorker) {\n          sendWorkerJob({\n            'job': 'loadVoice',\n            'args': [url]\n          }, 0, handler);\n        } else {\n          meSpeakCore.loadVoice(url, handler);\n        }\n      } else {\n        deferredLoaders.push({\n          'job': loadVoice,\n          'args': [url, callback]\n        });\n      }\n    }\n  }\n\n  function loadConfig(url) {}\n\n  function loadCustomConfig(url, callback) {\n    if (url && typeof url === 'string') {\n      if (coreReady) {\n        var handler = function (success, msg) {\n          if (success) onConfigLoaded(msg);\n          if (typeof callback === 'function') callback(success, msg);\n        };\n\n        url = getRelFileUrl(url);\n\n        if (hasWorker) {\n          sendWorkerJob({\n            'job': 'loadConfig',\n            'args': [url]\n          }, 0, handler);\n        } else {\n          meSpeakCore.loadConfig(url, handler);\n        }\n      } else {\n        deferredLoaders.push({\n          'job': loadCustomConfig,\n          'args': [url, callback]\n        });\n      }\n    }\n  }\n\n  function onConfigLoaded(voiceId) {\n    if (voiceId) {\n      voicesLoaded[voiceId] = true;\n      setDefaultVoice(voiceId);\n    }\n  }\n\n  function onVoiceLoaded(voiceId) {\n    if (voiceId) {\n      voicesLoaded[voiceId] = true;\n      setDefaultVoice(voiceId);\n      executeQueuedCalls();\n    }\n  }\n\n  function isVoiceLoaded(voice) {\n    return voicesLoaded[voice] ? true : false;\n  }\n\n  function isConfigLoaded() {\n    return true;\n  }\n\n  function getRunMode() {\n    return hasWorker ? 'worker' : 'instance';\n  }\n\n  function restartWithInstance() {\n    speakQueue.length = deferredLoaders.length = 0;\n    voicesLoaded = {};\n    workerCallbacks = {};\n    defaultVoice = '';\n    stopSound();\n    audioPool = {};\n    webSoundPool = {};\n    playbackVolume = 1;\n\n    if (hasWorker) {\n      if (worker) worker.terminate();\n      worker = null;\n      hasWorker = coreReady = false;\n      loadCore();\n    }\n  }\n\n  function unloadHandler(event) {\n    unloading = true;\n    stopSound();\n    audioPool = {};\n    webSoundPool = {};\n    workerCallbacks = {};\n    if (worker) worker.terminate();\n  }\n\n  function unlockAudio(event) {\n    event.returnValue = true;\n    if (audioUnlocked) return;\n\n    if (AudioAPI) {\n      try {\n        if (!audioContext) audioContext = new AudioAPI();\n        if (audioContext.state === 'suspended') audioContext.resume();\n        var gain = audioContext.createGain ? audioContext.createGain() : audioContext.createGainNode();\n      } catch (e) {}\n    }\n\n    audioUnlocked = true;\n    self.removeEventListener('touchstart', unlockAudio);\n    self.removeEventListener('mousedown', unlockAudio);\n  }\n\n  loadCore();\n  resolveAudioApi();\n  window.addEventListener('unload', unloadHandler, false);\n  if (isMobile && typeof self.ontouchstart !== undefined) self.addEventListener('touchstart', unlockAudio, {\n    'passive': true,\n    'capture': true\n  });else if (isSafari) self.addEventListener('mousedown', unlockAudio, true);\n  return {\n    'speak': speak,\n    'speakMultipart': speakMultipart,\n    'loadConfig': loadConfig,\n    'loadVoice': loadVoice,\n    'loadCustomConfig': loadCustomConfig,\n    'setDefaultVoice': setDefaultVoice,\n    'getDefaultVoice': getDefaultVoice,\n    'setVolume': setVolume,\n    'getVolume': getVolume,\n    'play': playSound,\n    'isConfigLoaded': isConfigLoaded,\n    'isVoiceLoaded': isVoiceLoaded,\n    'resetQueue': resetQueue,\n    'canPlay': canPlaybackWav,\n    'stop': stopSound,\n    'setFilter': setFilter,\n    'getRunMode': getRunMode,\n    'restartWithInstance': restartWithInstance,\n    'getAudioAnalyser': getAudioAnalyser,\n    'unlockAudio': unlockAudio\n  };\n}();","map":{"version":3,"sources":["/Users/henrysteinitz/Desktop/soulstream/lib/voice/mespeak/mespeak.js"],"names":["meSpeak","coreName","eSpeakDir","unloading","speakQueue","deferredLoaders","voicesLoaded","workerCallbacks","defaultVoice","AudioAPI","canPlay","playbackVolume","audioPool","webSoundPool","audioContext","masterOutput","masterGain","audioAnalyser","wsUseTimeout","wsStartFromCallback","isMobile","navigator","userAgent","test","isSafari","hasWorker","window","Worker","audioUnlocked","coreReady","baseUrl","worker","indexOf","parseInt","replace","match","loadCore","document","currentScript","src","scripts","getElementsByTagName","length","onmessage","coreReceiver","nodes","script","createElement","onload","coreLoaded","appendChild","self","console","error","event","msgType","data","rsp","jobId","t","ArrayBuffer","postMessage","byteLength","e","success","message","audiodata","sendWorkerJob","obj","callback","getJobId","String","i","l","loader","job","apply","args","executeQueuedCalls","speakMultipart","speak","resetQueue","text","id","rawdata","warn","log","push","voice","varg","v","substring","variant","argstack","amplitude","a","wordgap","g","pitch","p","speed","s","utf16","b","linebreak","capitals","k","nostop","z","punct","ssml","m","markup","join","state","resume","stream","resolveUtterance","volume","pan","meSpeakCore","exportStream","playSound","format","toLowerCase","Array","from","Uint8Array","prototype","slice","call","encode64","BASE","PAD","ret","leftchar","leftbits","Object","toString","curr","parts","failed","stackLength","streams","jobIds","n","part","opts","wav","sampleLength","first","buffer","readBytes","concat","writeBytes","outStream","set","f","value","shft","Math","floor","random","pow","relVolume","_id","streamType","parseFloat","isNaN","undefined","decodeBase64ToArray","playWebSound","isDataUrl","AudioPlayback","started","stopSound","kl","item","stopped","arguments","stop","stopWebSound","string","splice","setVolume","vol","setWebSoundVolume","gain","adjustVolume","getVolume","resolveAudioApi","AudioContext","vendors","api","audioElement","canPlayType","canPlaybackWav","audio","playing","play","that","addEventListener","remove","load","pause","source","gainNode","timer","sid","closed","createGain","createGainNode","connect","destination","createBufferSource","splitter","createChannelSplitter","merger","createChannelMerger","left","right","ratio","max","min","mixer","channelCount","channelCountMode","channelInterpretation","decodeAudioData","audioData","webSoundEndHandler","onended","duration","setTimeout","ceil","start","noteOn","err","clearTimeout","disconnect","sourcesource","noteOff","setFilter","biquadProps","compressorProps","inputNode","outputNode","filter","type","createBiquadFilter","j","e2","e1","createDynamicsCompressor","getAudioAnalyser","createAnalyser","setDefaultVoice","getDefaultVoice","getRelFileUrl","url","baseParts","exec","basePath","split","filePath","pop","loadVoice","handler","msg","onVoiceLoaded","loadConfig","loadCustomConfig","onConfigLoaded","voiceId","isVoiceLoaded","isConfigLoaded","getRunMode","restartWithInstance","terminate","unloadHandler","unlockAudio","returnValue","removeEventListener","ontouchstart"],"mappings":"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","sourcesContent":["/*\n\tmeSpeak-front\tv.2.0.7\n\tbased on speak.js, https://github.com/kripken/speak.js\n\teSpeak and other code here are under the GNU GPL.\n\tmeSpeak (Modular eSpeak) is a mod of 'speak.js' by N.Landsteiner (2011-2020), www.masswerk.at\n\tofficial project page: https://www.masswerk.at/mespeak\n*/\nvar meSpeak=(function(){\"use strict\";var coreName='mespeak-core.js',eSpeakDir='/espeak',unloading=false,speakQueue=[],deferredLoaders=[],voicesLoaded={},workerCallbacks={},defaultVoice='',AudioAPI=null,canPlay=false,playbackVolume=1,audioPool={},webSoundPool={},audioContext=null,masterOutput=null,masterGain=null,audioAnalyser=null,wsUseTimeout=false,wsStartFromCallback=false,isMobile=(typeof navigator!=='undefined'&&navigator.userAgent&&(/(Mobile|iPhone|iPad|iPod|Android|iOS)/i).test(navigator.userAgent)),isSafari=(typeof navigator!=='undefined'&&navigator.userAgent&&(/Safari/).test(navigator.userAgent)),hasWorker=(!isMobile&&typeof window!=='undefined'&&typeof window.Worker!=='undefined'),audioUnlocked=false,coreReady=false,baseUrl,worker;if(typeof navigator!=='undefined'&&navigator.userAgent){if(navigator.userAgent.indexOf('Chrome')!==-1){if(parseInt(navigator.userAgent.replace(/^.*?\\bChrome\\/([0-9]+).*$/,'$1'),10)>=32){wsUseTimeout=wsStartFromCallback=true;}}\nelse if(navigator.userAgent.match(/\\bVersion\\/[0-9]+\\.[0-9\\.]+ (Mobile\\/\\w+ )?Safari\\//)){if(parseInt(navigator.userAgent.replace(/^.*?\\bVersion\\/([0-9]+).*$/,'$1'),10)>=9){wsStartFromCallback=true;}}}\nfunction loadCore(){if(!baseUrl){if(document.currentScript){baseUrl=document.currentScript.src.replace(/[^\\/]+$/,'');}\nelse{var scripts=document.getElementsByTagName('script');baseUrl=scripts[scripts.length-1].src.replace(/[^\\/]+$/,'');}}\nif(baseUrl){if(hasWorker){worker=new Worker(baseUrl+coreName);worker.onmessage=coreReceiver;}\nelse{var nodes=document.getElementsByTagName('head');if(!nodes||!nodes.length)nodes=document.getElementsByTagName('head');if(nodes&&nodes.length){var script=document.createElement('script');script.src=baseUrl+coreName;script.onload=coreLoaded;nodes[0].appendChild(script);}}\nreturn true;}\nelse{if(self.console)console.error('MeSpeak: Failed to determine current script path.');return false;}}\nfunction coreReceiver(event){var msgType=event.data.rsp,jobId=event.data.jobId;switch(msgType){case'ready':try{var t=new ArrayBuffer(1);worker.postMessage({'job':'test','jobId':0,'test':t},[t]);if(!t.byteLength)worker.postMessage({'job':'useTransferables','jobId':0,'args':true});}\ncatch(e){}\ncoreLoaded();break;case'configLoaded':if(workerCallbacks[jobId])workerCallbacks[jobId](event.data.success,event.data.message);break;case'voiceLoaded':if(workerCallbacks[jobId])workerCallbacks[jobId](event.data.success,event.data.message);break;case'wav':if(workerCallbacks[jobId])workerCallbacks[jobId](event.data.audiodata);break;}\nif(workerCallbacks[jobId])delete workerCallbacks[jobId];}\nfunction sendWorkerJob(obj,jobId,callback){if(typeof callback==='function'){if(!jobId)jobId=getJobId();workerCallbacks[String(jobId)]=callback;}\nelse{jobId=0;}\nif(typeof obj.jobId==='undefined')obj.jobId=String(jobId);worker.postMessage(obj);}\nfunction coreLoaded(){coreReady=true;for(var i=0,l=deferredLoaders.length;i<l;i++){var loader=deferredLoaders[i];loader.job.apply(null,loader.args);}\ndeferredLoaders.length=0;}\nfunction executeQueuedCalls(){if(defaultVoice){for(var i=0,l=speakQueue.length;i<l;i++){var args=speakQueue[i];if(args[4]){speakMultipart(args[0],args[1],args[2],args[3]);}\nelse{speak(args[0],args[1],args[2],args[3]);}}\nspeakQueue.length=0;}}\nfunction resetQueue(){speakQueue.length=0;}\nfunction speak(text,args,callback,id){if(typeof args!=='object'||!args)args={};if(!canPlay&&!args.rawdata){if(self.console)console.warn('meSpeak: Can\\'t play; No audio support.');return 0;}\nif(!id)id=getJobId();if(!coreReady||!defaultVoice){if(self.console)console.log('No voice module loaded, deferring call.');if(args.rawdata){return id;}\nelse{speakQueue.push([text,args,callback,id,false]);return id;}}\nif(args&&args.voice&&!voicesLoaded[args.voice]){if(self.console)console.log('Voice '+args.voice+' not available. Using default voice: '+defaultVoice);args.voice=defaultVoice;}\nvar varg=(args.voice)?String(args.voice):(args.v)?String(args.v):defaultVoice;if(varg.indexOf('mb/mb-')==0)varg=varg.substring(3);if(args.variant)varg+='+'+String(args.variant).replace(/\\+/g,'');var argstack=['-w','wav.wav','-a',(typeof args.amplitude!=='undefined')?String(args.amplitude):(typeof args.a!=='undefined')?String(args.a):'100','-g',(typeof args.wordgap!=='undefined')?String(args.wordgap):(typeof args.g!=='undefined')?String(args.g):'0','-p',(typeof args.pitch!=='undefined')?String(args.pitch):(typeof args.p!=='undefined')?String(args.p):'50','-s',(typeof args.speed!=='undefined')?String(args.speed):(typeof args.s!=='undefined')?String(args.s):'175','-b',args.utf16?'4':(typeof args.b!=='undefined')?String(args.b):'1','-v',varg];var a=args.linebreak||args.l;if(a)argstack.push('-l',String(a));a=args.capitals||args.k;if(a)argstack.push('-k',String(a));a=args.nostop||args.z;if(a)argstack.push('-z');if(typeof args.punct!=='undefined'){if(typeof args.punct==='string'){if(args.punct.length){argstack.push('--punct=\"'+String(args.punct).replace(/([\\\\\"'])/g,'\\\\$1')+'\"');}\nelse{argstack.push('--punct');}}\nelse if(args.punct){argstack.push('--punct');}}\na=args.ssml||args.m||args.markup;if(a)argstack.push('-m');argstack.push('--path='+eSpeakDir,String(text));if(args.log&&self.console)console.log('executing espeak '+argstack.join(' '));if(typeof callback!=='function')callback=null;if(!callback&&typeof args.callback=='function')callback=args.callback;if(!args.rawdata&&AudioAPI){if(!audioContext)audioContext=new AudioAPI();if(audioContext.state==='suspended')audioContext.resume();}\nif(hasWorker){sendWorkerJob({'job':'speak','args':argstack},id,function(stream){resolveUtterance(stream,id,args.rawdata,args.volume,args.pan||0,callback);});}\nelse{resolveUtterance(meSpeakCore.speak(argstack),id,args.rawdata,args.volume,args.pan||0,callback);}\nreturn id;}\nfunction resolveUtterance(stream,id,rawdata,volume,pan,callback){if(stream){if(rawdata){if(callback)callback(true,id,exportStream(stream,rawdata));}\nelse{playSound(stream,volume,callback,id,pan);}}\nelse if(callback){callback(false,id);}}\nfunction exportStream(stream,format){switch(String(format).toLowerCase()){case'array':return Array.from?Array.from(new Uint8Array(stream)):Array.prototype.slice.call(new Uint8Array(stream));case'base64':return encode64(stream);case'data-url':case'data-uri':case'dataurl':case'datauri':case'mime':return'data:audio/x-wav;base64,'+encode64(new Uint8Array(stream));default:return stream;}}\nfunction encode64(data){var BASE='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',PAD='=',ret='',leftchar=0,leftbits=0,l=Object.prototype.toString.call(data)==='[object Array]'?data.length:data.byteLength;for(var i=0;i<l;i++){leftchar=(leftchar<<8)|data[i];leftbits+=8;while(leftbits>=6){var curr=(leftchar>>(leftbits-6))&0x3f;leftbits-=6;ret+=BASE[curr];}}\nif(leftbits==2){ret+=BASE[(leftchar&3)<<4];ret+=PAD+PAD;}else if(leftbits==4){ret+=BASE[(leftchar&0xf)<<2];ret+=PAD;}\nreturn ret;}\nfunction speakMultipart(parts,args,callback,id){if(typeof args!=='object'||!args)args={};if(!canPlay&&!args.rawdata){if(self.console)console.warn('meSpeak: Can\\'t play; No audio support.');return 0;}\nvar failed=false;if(typeof callback!=='function')callback=null;if(!callback&&typeof args.callback=='function')callback=args.callback;if(Object.prototype.toString.call(parts)!='[object Array]'||!parts.length){if(self.console)console.warn('meSpeak.speakMultipart: First argument must be an array of objects.');failed=true;}\nif(!failed){for(var i=0,l=parts.length;i<l;i++){if(typeof parts[i]!='object'){if(self.console)console.warn('meSpeak.speakMultipart: First argument must be an array of objects (part #'+i+').');failed=true;break;}}}\nif(failed){if(callback)callback(false,id||0);return 0;}\nif(!id)id=getJobId();if(!coreReady||!defaultVoice){if(self.console)console.log('No voice module loaded, deferring call.');if(args.rawdata){return null;}\nelse{speakQueue.push([parts,args,callback,id,true]);return id;}}\nvar stackLength=parts.length,streams={},jobIds=[];for(var i=0;i<stackLength;i++)jobIds.push(getJobId());for(var i=0;i<parts.length;i++){var n,part=parts[i]||{},opts={};for(n in args)opts[n]=args[n];for(n in part)opts[n]=part[n];opts.rawdata='array';opts.callback=null;speak(part.text,opts,function(success,jobId,stream){if(success)streams[jobId]=stream;if(--stackLength===0){var wav,sampleLength=0,first=true;for(var i=0;i<jobIds.length;i++){var buffer=streams[jobIds[i]];if(buffer){sampleLength+=readBytes(buffer,40,4);if(first){wav=buffer;first=false;}\nelse{wav=wav.concat(buffer.slice(44));}}}\nstreams=buffer=null;writeBytes(wav,4,4,sampleLength);writeBytes(wav,40,4,sampleLength);var outStream=new ArrayBuffer(wav.length);new Uint8Array(outStream).set(wav);resolveUtterance(outStream,id,args.rawdata,args.volume,args.pan||0,callback);}},jobIds[i]);}\nreturn id;}\nfunction writeBytes(f,p,n,value){while(n){f[p++]=value&0xff;value=value>>8;n--;}}\nfunction readBytes(f,p,n){var value=0,shft=0;while(n){value|=f[p++]<<shft;shft+=8;n--;}\nreturn value;}\nfunction getJobId(){var n,s;while(!n||audioPool[s]||webSoundPool[s]||workerCallbacks[s]){n=Math.floor(Math.random()*Math.pow(2,32));s=n.toString();}\nreturn n;}\nfunction playSound(stream,relVolume,callback,_id,pan){if(callback&&(typeof callback!=='function'))callback=null;if(!_id)_id=getJobId();var streamType=Object.prototype.toString.call(stream);if(!(streamType=='[object Array]'||streamType=='[object ArrayBuffer]'||streamType=='[object String]')){if(self.console)console.log('meSpeak: Can\\'t play, not an Array, or ArrayBuffer, or base64-String: '+streamType);if(callback)callback(false,_id||0);return 0;}\nif(typeof relVolume!=='undefined'){relVolume=parseFloat(relVolume);if(isNaN(relVolume)||relVolume<0||relVolume>1)relVolume=undefined;}\nif(AudioAPI){if(streamType=='[object String]'){if(stream.indexOf('data:audio/x-wav;base64,',0)==0)stream=stream.substring(24);stream=stream.replace(/=+$/,'');if(stream.match(/[^A-Za-z0-9\\+\\/]/)){if(self.console)console.log('meSpeak: Can\\'t play, not a proper base64-String.');if(callback)callback(false,_id||0);return 0;}\nstream=decodeBase64ToArray(stream);if(!stream.length){if(self.console)console.log('meSpeak: Can\\'t play, empty sound data.');if(callback)callback(false,_id||0);return 0;}\nstreamType='[object Array]';}\nvar buffer;if(streamType=='[object Array]'){var buffer=new ArrayBuffer(stream.length);new Uint8Array(buffer).set(stream);}\nelse{buffer=stream;}\nreturn playWebSound(buffer,relVolume,callback,_id,pan);}\nelse if(canPlay){var isDataUrl=false;if(streamType=='[object String]'){if(stream.indexOf('data:audio/x-wav;base64,',0)<0){if(stream.match(/[^A-Za-z0-9\\+\\/]/)){if(self.console)console.log('meSpeak: Can\\'t play, not a proper base64-String.');if(callback)callback(false,_id||0);return 0;}\nstream='data:audio/x-wav;base64,'+stream;}\nisDataUrl=true;}\nelse if(streamType=='[object ArrayBuffer]'){stream=new Uint8Array(stream);}\nreturn(new AudioPlayback(stream,relVolume,isDataUrl,callback,_id).started)?_id:0;}\nelse{if(self.console)console.log('meSpeak: Can\\'t play; No audio support.');if(callback)callback(false,_id||0);return 0;}}\nfunction stopSound(){var id,i,k,kl,l,item,n,stopped=0;if(arguments.length>0){for(i=0,l=arguments.length;i<l;i++){n=parseInt(arguments[i]);if(n&&!isNaN(n)){id=n.toString();if(audioPool[id]){audioPool[id].stop();stopped++;}\nelse if(webSoundPool[id]){stopWebSound(webSoundPool[id]);stopped++;}\nelse{for(k=0,kl=speakQueue.length;k<kl;k++){item=speakQueue[i];if(item[3].string===id){if(!unloading&&typeof item[2]=='function')item[2](false);speakQueue.splice(k,1);stopped++;break;}}}}}}\nelse{for(id in audioPool){audioPool[id].stop();stopped++;}\nfor(id in webSoundPool){stopWebSound(webSoundPool[id]);stopped++;}\nfor(i=0,l=speakQueue.length;i<l;i++){item=speakQueue[i];if(!unloading&&typeof item[2]=='function')item[2](false);stopped++;}\nspeakQueue.length=0;}\nreturn stopped;}\nfunction setVolume(vol){var id,i,l,n,v;v=parseFloat(vol);if(!isNaN(v)&&v>=0&&v<=1&&v!=playbackVolume){if(arguments.length==1)playbackVolume=v;if(AudioAPI){if(arguments.length>1){for(i=0,l=arguments.length;i<l;i++){n=parseInt(arguments[i]);if(n&&!isNaN(n)){id=n.toString();if(webSoundPool[id])setWebSoundVolume(webSoundPool[id],v);}}}\nelse if(masterGain){masterGain.gain.value=playbackVolume;}}\nelse if(canPlay){if(arguments.length>1){for(i=0,l=arguments.length;i<l;i++){n=parseInt(arguments[i]);if(n&&!isNaN(n)){id=n.toString();if(audioPool[id])audioPool[id].setVolume(v);}}}\nelse{for(id in audioPool)audioPool[id].adjustVolume();}}}\nreturn vol;}\nfunction getVolume(){if(arguments.length){var n=parseInt(arguments[0]);if(n&&!isNaN(n)){var id=n.toString();if(webSoundPool[id])return webSoundPool[id].relVolume;if(audioPool[id])return audioPool[id].relVolume;}\nreturn undefined;}\nelse{return playbackVolume;}}\nfunction resolveAudioApi(){if(self.AudioContext){AudioAPI=self.AudioContext;canPlay=true;return;}\nelse{var vendors=['webkit','moz','o','ms'];for(var i=0;i<vendors.length;i++){var api=self[vendors[i]+'AudioContext'];if(api){AudioAPI=api;canPlay=true;return;}}}\nif(!AudioAPI){var audioElement=document.createElement('audio');if(audioElement&&audioElement.canPlayType&&(audioElement.canPlayType('audio/wav')||audioElement.canPlayType('audio/x-wav'))){canPlay=true;}\nelse{canPlay=false;if(self.console)console.log('meSpeak: Muted. No support for HTMLAudioElement with MIME \"audio/x-wav\" dected.');}}}\nfunction canPlaybackWav(){return canPlay;}\nfunction AudioPlayback(stream,relVolume,isDataUrl,callback,id){this.relVolume=relVolume;this.audio=null;this.id=String(id);this.callback=(typeof callback=='function')?callback:null;this.playing=false;this.started=false;this.play(stream,isDataUrl);}\nAudioPlayback.prototype={play:function(stream,isDataUrl){try{audioPool[this.id]=this;this.audio=document.createElement('audio');this.adjustVolume();var that=this;this.audio.addEventListener('ended',function(){that.remove();},false);this.audio.addEventListener('canplaythrough',function(){that.audio.play();that.playing=true;},false);if(isDataUrl){this.audio.src=stream;}\nelse{this.audio.src='data:audio/x-wav;base64,'+encode64(stream);}\nthis.audio.load();this.started=true;}\ncatch(e){if(self.console)console.log('meSpeak: HTMLAudioElement Exception: '+e.message);this.started=false;this.remove();}},adjustVolume:function(){this.audio.volume=(typeof this.relVolume!=='undefined')?this.relVolume*playbackVolume:playbackVolume;},setVolume:function(v){this.relVolume=v;this.adjustVolume();},remove:function(stopped){if(this.id)delete audioPool[this.id];if(this.callback){var f=this.callback;this.callback=null;var id=this.id||0;if(!unloading)f(!stopped,id);}},stop:function(){try{if(this.playing)this.audio.pause();}\ncatch(e){}\nthis.remove(true);}};function playWebSound(stream,volume,callback,id,pan){try{var source,gainNode,timer,relVolume,sid=String(id);if(!audioContext){audioContext=new AudioAPI();}\nelse if(audioContext.closed){audioContext=new AudioAPI();audioAnalyser=masterOutput=masterGain=null;}\nif(!masterGain){masterGain=(audioContext.createGain)?audioContext.createGain():audioContext.createGainNode();masterGain.connect(audioContext.destination);masterGain.gain.value=playbackVolume;if(!masterOutput)masterOutput=masterGain;}\nsource=audioContext.createBufferSource();relVolume=parseFloat(volume);if(typeof relVolume==='undefined'||isNaN(relVolume)||relVolume<0||relVolume>1)relVolume=1;gainNode=(audioContext.createGain)?audioContext.createGain():audioContext.createGainNode();gainNode.gain.value=relVolume;if(pan&&!isNaN(pan)){try{var splitter=audioContext.createChannelSplitter(2),merger=audioContext.createChannelMerger(2),left=(audioContext.createGain)?audioContext.createGain():audioContext.createGainNode(),right=(audioContext.createGain)?audioContext.createGain():audioContext.createGainNode(),ratio=Math.max(-1,Math.min(1,parseFloat(pan))),mixer=(audioContext.createGain)?audioContext.createGain():audioContext.createGainNode();mixer.channelCount=2;mixer.channelCountMode='explicit';mixer.channelInterpretation='speakers';left.gain.value=ratio<0?1:1-ratio;right.gain.value=ratio>0?1:1+ratio;mixer.connect(splitter);splitter.connect(left,0);splitter.connect(right,1);left.connect(merger,0,0);right.connect(merger,0,1);merger.connect(gainNode);source.connect(mixer);}\ncatch(e){source.connect(gainNode);}}\nelse{source.connect(gainNode);}\nif(audioAnalyser)gainNode.connect(audioAnalyser);gainNode.connect(masterOutput);audioContext.decodeAudioData(stream,function(audioData){var f=function(){webSoundEndHandler(source,gainNode,callback,true,id);};if(wsUseTimeout||typeof source.onended==='undefined'){var duration=audioData.duration;timer=setTimeout(f,duration?Math.ceil(duration*1000):10);}\nelse{source.onended=f;}\nsource.buffer=audioData;if(wsStartFromCallback){if(source.start){source.start(0);}\nelse{source.noteOn(0);}}},function(err){console.log('meSpeak: Web Audio Decoding Error: '+((typeof err=='object')?err.message:err));if(timer)clearTimeout(timer);if(source)source.disconnect();if(gainNode)gainNode.disconnect();if(webSoundPool[sid])delete webSoundPool[sid];if(!unloading&&typeof callback=='function')callback(false,id);return 0;});webSoundPool[sid]={'source':source,'gainNode':gainNode,'callback':callback,'id':id,'relVolume':relVolume,'timer':timer};if(!wsStartFromCallback){if(source.start){source.start(0);}\nelse{source.noteOn(0);}}\nreturn id;}\ncatch(e){if(self.console)console.log('meSpeak: Web Audio Exception: '+e.message);if(timer){clearTimeout(timer);timer=0;}\nwebSoundEndHandler(source,gainNode,callback,false,id);return 0;}}\nfunction webSoundEndHandler(source,gainNode,callback,success,id){var sid=String(id);if(sid&&webSoundPool[sid]&&webSoundPool[sid].timer)clearTimeout(webSoundPool[sid].timer);if(!unloading&&typeof callback=='function')callback(success,id);var f=function(){if(source){if(typeof source.onended!=='undefined')source.onended=null;source.disconnect();}\nif(gainNode)gainNode.disconnect();if(sid&&webSoundPool[sid])delete webSoundPool[sid];};if(!success){f();}\nelse{setTimeout(f,500);}}\nfunction stopWebSound(obj){try{if(obj.source.stop){obj.source.stop(0);}\nelse{obj.sourcesource.noteOff(0);}}\ncatch(e){}\nwebSoundEndHandler(obj.source,obj.gainNode,obj.callback,false,obj.id);}\nfunction setFilter(){var biquadProps=['frequency','Q','gain','detune'],compressorProps=['threshold','knee','ratio','reduction','attack','release'];if(!AudioAPI)return;if(!audioContext){audioContext=new AudioAPI();}\nelse if(audioContext.closed){audioContext=new AudioAPI();audioAnalyser=masterOutput=masterGain=null;}\nvar inputNode,outputNode;for(var i=0;i<arguments.length;i++){var data=arguments[i];if(Object.prototype.toString.call(data)!=='[object Object]'){if(self.console)console.warn('meSpeak.setFilter(): argument must be an object, ignoring argument '+i+'.');continue;}\nvar filter,type=String(data.type).toLowerCase();switch(type){case'lowpass':case'highpass':case'bandpass':case'lowshelf':case'highshelf':case'peaking':case'notch':case'allpass':try{filter=audioContext.createBiquadFilter();filter.type=type;for(var j=0;j<biquadProps.length;j++){var p=biquadProps[j];try{if(!isNaN(data[p]))filter[p].value=data[p];}\ncatch(e2){if(self.console)console.warn('meSpeak.setFilter(), filter-type: \"'+type+'\", parameter: \"'+p+'\": '+e2.message);};}}\ncatch(e1){if(self.console)console.warn('meSpeak.setFilter(): Failed to create filter \"'+type+'\", '+e1.message);};break;case'dynamicscompressor':case'compressor':try{filter=audioContext.createDynamicsCompressor();for(var j=0;j<compressorProps.length;j++){var p=compressorProps[j];try{if(!isNaN(data[p]))filter[p].value=data[p];}\ncatch(e2){if(self.console)console.warn('meSpeak.setFilter(), filter-type: \"'+type+'\", parameter: \"'+p+'\": '+e2.message);};}\nbreak;}\ncatch(e1){if(self.console)console.warn('meSpeak.setFilter(): Failed to create filter \"'+type+'\", '+e1.message);};default:if(self.console)console.warn('meSpeak.setFilter(): unknown filter type \"'+type+'\".');filter=null;break;}\nif(filter){if(!inputNode){inputNode=filter;}\nelse{inputNode.connect(filter);}\noutputNode=filter;}}\nif(outputNode){if(!masterGain){masterGain=(audioContext.createGain)?audioContext.createGain():audioContext.createGainNode();masterGain.connect(audioContext.destination);masterGain.gain.value=playbackVolume;}\noutputNode.connect(masterGain);masterOutput=inputNode;}\nelse{masterOutput=masterGain;}}\nfunction getAudioAnalyser(){if(!AudioAPI)return;if(!audioContext){audioContext=new AudioAPI();}\nelse if(audioContext.closed){audioContext=new AudioAPI();audioAnalyser=masterOutput=masterGain=null;}\naudioAnalyser=audioContext.createAnalyser();return audioAnalyser;}\nfunction setWebSoundVolume(obj,v){obj.gainNode.gain.value=v;obj.relVolume=v;}\nfunction setDefaultVoice(voice){if(voice){if(!coreReady){deferredLoaders.push({'job':setDefaultVoice,'args':[voice]});}\nelse if(voicesLoaded[voice]){defaultVoice=voice;}}}\nfunction getDefaultVoice(){return defaultVoice;}\nfunction getRelFileUrl(url){if((/^(\\/|https?:|ftps?:|file:)/i).test(url))return url;else{var baseParts=(/^(https?|ftps?|file)(\\:\\/\\/)([^\\/]*\\/)(.*)$/i).exec(baseUrl),basePath=baseParts[4].split('/'),filePath=url.split('/');for(var i=0;i<filePath.length;i++){var p=filePath[i];if(p==='.')continue;if(p==='..'){basePath.pop();}\nelse{basePath.push(p);}}\nreturn baseParts[1]+baseParts[2]+baseParts[3]+basePath.join('/');}}\nfunction loadVoice(url,callback){if(url&&typeof url==='string'){if(coreReady){var handler=function(success,msg){if(success)onVoiceLoaded(msg);if(typeof callback==='function')callback(success,msg);};if((/^[\\w\\-]+(\\/[\\w\\-]+)?$/).test(url)){url='voices/'+url+'.json';}\nurl=getRelFileUrl(url);if(hasWorker){sendWorkerJob({'job':'loadVoice','args':[url]},0,handler);}\nelse{meSpeakCore.loadVoice(url,handler);}}\nelse{deferredLoaders.push({'job':loadVoice,'args':[url,callback]});}}}\nfunction loadConfig(url){}\nfunction loadCustomConfig(url,callback){if(url&&typeof url==='string'){if(coreReady){var handler=function(success,msg){if(success)onConfigLoaded(msg);if(typeof callback==='function')callback(success,msg);};url=getRelFileUrl(url);if(hasWorker){sendWorkerJob({'job':'loadConfig','args':[url]},0,handler);}\nelse{meSpeakCore.loadConfig(url,handler);}}\nelse{deferredLoaders.push({'job':loadCustomConfig,'args':[url,callback]});}}}\nfunction onConfigLoaded(voiceId){if(voiceId){voicesLoaded[voiceId]=true;setDefaultVoice(voiceId);}}\nfunction onVoiceLoaded(voiceId){if(voiceId){voicesLoaded[voiceId]=true;setDefaultVoice(voiceId);executeQueuedCalls();}}\nfunction isVoiceLoaded(voice){return voicesLoaded[voice]?true:false;}\nfunction isConfigLoaded(){return true;}\nfunction getRunMode(){return hasWorker?'worker':'instance';}\nfunction restartWithInstance(){speakQueue.length=deferredLoaders.length=0;voicesLoaded={};workerCallbacks={};defaultVoice='';stopSound();audioPool={};webSoundPool={};playbackVolume=1;if(hasWorker){if(worker)worker.terminate();worker=null;hasWorker=coreReady=false;loadCore();}}\nfunction unloadHandler(event){unloading=true;stopSound();audioPool={};webSoundPool={};workerCallbacks={};if(worker)worker.terminate();}\nfunction unlockAudio(event){event.returnValue=true;if(audioUnlocked)return;if(AudioAPI){try{if(!audioContext)audioContext=new AudioAPI();if(audioContext.state==='suspended')audioContext.resume();var gain=(audioContext.createGain)?audioContext.createGain():audioContext.createGainNode();}\ncatch(e){}}\naudioUnlocked=true;self.removeEventListener('touchstart',unlockAudio);self.removeEventListener('mousedown',unlockAudio);}\nloadCore();resolveAudioApi();window.addEventListener('unload',unloadHandler,false);if(isMobile&&typeof self.ontouchstart!==undefined)self.addEventListener('touchstart',unlockAudio,{'passive':true,'capture':true});else if(isSafari)self.addEventListener('mousedown',unlockAudio,true);return{'speak':speak,'speakMultipart':speakMultipart,'loadConfig':loadConfig,'loadVoice':loadVoice,'loadCustomConfig':loadCustomConfig,'setDefaultVoice':setDefaultVoice,'getDefaultVoice':getDefaultVoice,'setVolume':setVolume,'getVolume':getVolume,'play':playSound,'isConfigLoaded':isConfigLoaded,'isVoiceLoaded':isVoiceLoaded,'resetQueue':resetQueue,'canPlay':canPlaybackWav,'stop':stopSound,'setFilter':setFilter,'getRunMode':getRunMode,'restartWithInstance':restartWithInstance,'getAudioAnalyser':getAudioAnalyser,'unlockAudio':unlockAudio};})();"]},"metadata":{},"sourceType":"script"}